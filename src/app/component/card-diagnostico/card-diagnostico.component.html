<section class="max-w-[1100px] m-auto mt-5">
  <div class="font-sans text-slate-900">

    <!-- Card Principal -->
    <div class="rounded-xl border bg-card text-card-foreground shadow-sm bg-white">

      <!-- Card Header -->
      <div class="flex flex-col space-y-1.5 p-6">
        <h3 class="font-semibold leading-none tracking-tight flex items-center gap-2 text-2xl">
          <div class="h-6 w-6 text-blue-600 flex items-center justify-center" [innerHTML]="getIcon('stethoscope')"></div>
          Diagnóstico Guiado
        </h3>
      </div>

      <!-- Card Content -->
      <div class="p-6 pt-0">
        <p class="text-sm text-slate-500 mb-6">
          Selecione um sintoma para ver possíveis causas e recomendações:
        </p>

        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
          @for (symptom of symptoms; track symptom.id; let i = $index) {
          <button class="flex flex-col items-center justify-center gap-3 p-4 h-auto rounded-md border border-slate-200 bg-transparent hover:border-blue-600 hover:bg-blue-50 transition-all duration-300 animate-scale-in" [style.animation-delay]="(i * 50) + 'ms'" (click)="selectSymptom(symptom)">
            <div class="h-8 w-8 text-blue-600 flex items-center justify-center" [innerHTML]="getIcon(symptom.iconKey)"></div>
            <span class="text-xs font-medium text-center text-slate-700">{{ symptom.label }}</span>
          </button>
          }
        </div>
      </div>
    </div>

    <!-- Modal / Dialog -->
    @if (selectedSymptom(); as activeSymptom) {
    <div class="fixed inset-0 z-50 flex items-center justify-center">

      <!-- Backdrop -->
      <div class="fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity animate-in fade-in" (click)="closeDialog()"></div>

      <!-- Conteúdo do Dialog -->
      <div class="relative z-50 w-full max-w-lg gap-4 border bg-white p-6 shadow-lg sm:rounded-lg animate-in zoom-in-95 duration-200 mx-4">

        <!-- Botão fechar (X) -->
        <button (click)="closeDialog()" class="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2">
          <div class="h-4 w-4 flex items-center justify-center" [innerHTML]="getIcon('x')"></div>
          <span class="sr-only">Fechar</span>
        </button>

        <!-- Dialog Header -->
        <div class="flex flex-col space-y-1.5 text-center sm:text-left mb-6">
          <h2 class="text-lg font-semibold leading-none tracking-tight flex items-center gap-2">
            <div class="h-5 w-5 text-blue-600 flex items-center justify-center" [innerHTML]="getIcon(activeSymptom.iconKey)"></div>
            {{ activeSymptom.label }}
          </h2>
          <p class="text-sm text-slate-500">
            Possíveis causas e recomendações para este sintoma
          </p>
        </div>

        <div class="space-y-6">
          <!-- Seção Causas -->
          <div>
            <h4 class="font-semibold text-slate-900 flex items-center gap-2 mb-3">
              <div class="h-4 w-4 text-amber-500 flex items-center justify-center" [innerHTML]="getIcon('alertCircle')"></div>
              Possíveis Causas
            </h4>
            <ul class="space-y-2">
              @for (cause of activeSymptom.causes; track $index) {
              <li class="flex items-start gap-2 text-sm text-slate-600">
                <span class="text-blue-600 mt-1">•</span>
                {{ cause }}
              </li>
              }
            </ul>
          </div>

          <!-- Seção Recomendações -->
          <div>
            <h4 class="font-semibold text-slate-900 flex items-center gap-2 mb-3">
              <div class="h-4 w-4 text-green-500 flex items-center justify-center" [innerHTML]="getIcon('chevronRight')"></div>
              Recomendações
            </h4>
            <ul class="space-y-2">
              @for (rec of activeSymptom.recommendations; track $index) {
              <li class="flex items-start gap-2 text-sm text-slate-600">
                <span class="text-green-500 mt-1">✓</span>
                {{ rec }}
              </li>
              }
            </ul>
          </div>

          <!-- Botão de Ação -->
          <button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 h-10 px-4 py-2 w-full shadow-md">
            Agendar Diagnóstico Profissional
          </button>
        </div>

      </div>
    </div>
    }
  </div>
</section>
